# 20250505004

## 问题描述
双击任务，弹出任务详细页，同时页会在任务列表中显示子任务。
再次双击，子任务消失
不易于理解。应该，将打开任务详细页，和现实子任务改为两个不同的动作。

## 定位过程
- 分析代码，_populate_tasks方法，用于填充任务数据。这个方法里，只要有子任务，就应该插入到 treeview 中才对。但是，为什么，打开窗口时，没有现实子任务呢？
- pdb 跟踪，发现首次进入时，传入的 taks 只有两个数据
- 递归时，发现第一个task没有subtasks；第二个也没有
- 上层， _create_widgets， 是传入的 milestone 的 tasks
- 分析 Milestone 代码
    - 数据是从 ProgressTracker 的 load_data 方法恢复的
    - 使用 from_dict 方法
    - 这里恢复 tasks 时，只恢复了 tasks 字段里的 task
    - 在 task 恢复时，会恢复 subtasks
- 跟踪一下 load_data 
    - OpenCV基础，确实添加了子任务
- 继续跟踪，发现在 _populate_tasks 时，确实进入了添加子任务的代码，但是为什么没有显示呢？
- 减少影响，将 创建 TaskWindow 的代码注释掉，再试试，看下双击是哪里刷新的列表
    - 没有创建任务，仍然会显示子任务

## 根因分析
- 双击任务，显示子任务，是treeview自己的行为，与我的代码没关系
## 修改方案分析
### 方案一
- 修改 treeview 默认行为，单机展开/折叠子任务
缺点：双击时，实际识别为两次单击，所以会导致先展开再折叠

### 方案二
- 修改双击显示详情页的逻辑，例如增加按钮
缺点：不是默认习惯，增加负担

### 方案三
- 不要使用tree结构，即虽然递归显示任务，但是都在同一级显示，不存在父子关系
优点：不修改双击显示详情页的逻辑，易于操作；
缺点：子任务很多时，不利于展示；通过treeview的关系，与表中保存的数据结构有差异：data是按照父子关系保存，而treeview是平坦保存。查找是否会出问题？

### 方案分析结果
方案一

## 合入记录
提交 ID：655f9f9d945cfecb013c2826f9ac4012909f83b7
提交信息：- 修改 treeview 默认行为，单机展开/折叠子任务
#20250505004

## 验证过程
双击任务，可以打开任务详细页；虽然，子任务还是会展开，但最终会折叠（即恢复双击前的状态）
单击任务，可以展开/折叠子任务列表